package news.dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.ArrayList;

import step01.JsoupTest;

public class NewDAO {
	
	// 특정 부서 생성 : INSERT INTO dept VALUES (deptno, dname, loc);
		public static boolean intsertData() throws SQLException{
			Connection conn = null;
			PreparedStatement pstmt = null;
			
			try {
				conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/SCOTT?serverTimezone=Asia/Seoul", "SCOTT", "TIGER");
				pstmt = conn.prepareStatement("INSERT INTO news VALUES (?, ?)");
				ArrayList<String> titles = JsoupTest.Titlesget();
				ArrayList<String> links = JsoupTest.Linksget();
			
				
				for (int i=0; i < titles.size(); i++) {
					
					pstmt.setString(1, titles.get(i));
					pstmt.setString(2, links.get(i));
					pstmt.executeUpdate();
				}

				
				int result = pstmt.executeUpdate();
				
				// 5단계
				if(result != 0) {
					return true;
				}
				// 6단계
			} finally {
				
				if (pstmt != null) {
			        pstmt.close();
			        }
		        if (conn != null) {
		            conn.close();
		        }
			}
			
			return false;
		}
		
			
			
			
	
}
